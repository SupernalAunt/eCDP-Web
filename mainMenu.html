<audio id="menuMusic" src="assets/audio/BG_04.wav" loop autoplay></audio>

<div style="margin-top: 1em;">
  <label for="soundtrack"><span class="material-icons">music_note</span> Soundtrack:</label>
  <select id="soundtrack" onchange="changeTrack(this.value)">
    <option value="BG_04.wav">Shift Starts</option>
    <option value="BG_03.wav">eCDP Exercise</option>
    <option value="BG_09.wav">In The Menus</option>
  </select>

  <label for="volume"><span class="material-icons">volume_up</span> Volume:</label>
  <input type="range" id="volume" min="0" max="1" step="0.01" value="1" onchange="adjustVolume(this.value)">
</div>

<footer>
  <img src="assets/images/mclogo.png" alt="McDonald's Logo" />
  <span>eCDP Web Training Platform</span>
</footer>

<script type="module">
  import { auth } from './firebase.js';
  import {
    onAuthStateChanged,
    signOut
  } from "https://www.gstatic.com/firebasejs/10.3.1/firebase-auth.js";

  onAuthStateChanged(auth, user => {
    if (user) {
      document.getElementById('crewName').textContent = user.email;
    } else {
      window.location.href = "index.html";
    }
  });

  const startModule = (moduleName) => {
    window.location.href = `modules/${moduleName}.html`;
  };

  const loadLeaderboard = () => {
    alert("Leaderboard coming soon!");
  };

  const logout = () => {
    const music = document.getElementById('menuMusic');
    if (music) music.pause();
    signOut(auth).then(() => {
      window.location.href = "index.html";
    });
  };

  const changeTrack = (filename) => {
    const music = document.getElementById('menuMusic');
    if (music) {
      music.src = `assets/audio/${filename}`;
      music.play();
    }
  };

  const adjustVolume = (value) => {
    const music = document.getElementById('menuMusic');
    if (music) music.volume = parseFloat(value);
  };

  window.startModule = startModule;
  window.loadLeaderboard = loadLeaderboard;
  window.logout = logout;
  window.changeTrack = changeTrack;
  window.adjustVolume = adjustVolume;
</script>
